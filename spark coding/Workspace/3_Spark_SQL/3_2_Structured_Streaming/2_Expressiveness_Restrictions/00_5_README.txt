
------------------------------------------- 

 EXAMPLES

------------------------------------------- 

The Structured Streaming library includes some expressiveness restrictions, which we list in these examples. 

For all of them we have taken case of single_step_window, either with complete and append modes (depending on the example).  

------------------------------------------- 

 17_intro.py

------------------------------------------- 

This example is a copy of 10_single_step_window.py, so we obtain the same results as we did by then. 

-------------------------------------------
Batch: 0
-------------------------------------------
+----+-----+------------+----------+
|word|count|window_start|window_end|
+----+-----+------------+----------+
+----+-----+------------+----------+

-------------------------------------------
Batch: 1
-------------------------------------------
+----+-----+------------+----------+
|word|count|window_start|window_end|
+----+-----+------------+----------+
+----+-----+------------+----------+

-------------------------------------------
Batch: 2
-------------------------------------------
+----+-----+------------+----------+
|word|count|window_start|window_end|
+----+-----+------------+----------+
+----+-----+------------+----------+

-------------------------------------------
Batch: 3
-------------------------------------------
+-------+-----+-------------------+-------------------+
|   word|count|       window_start|         window_end|
+-------+-----+-------------------+-------------------+
|Goodbye|    3|2018-11-29 11:49:20|2018-11-29 11:49:40|
|  Hello|    3|2018-11-29 11:49:20|2018-11-29 11:49:40|
+-------+-----+-------------------+-------------------+

-------------------------------------------
Batch: 4
-------------------------------------------
+-----+-----+-------------------+-------------------+
| word|count|       window_start|         window_end|
+-----+-----+-------------------+-------------------+
|Again|    3|2018-11-29 11:50:00|2018-11-29 11:50:20|
|Hello|    3|2018-11-29 11:50:00|2018-11-29 11:50:20|
+-----+-----+-------------------+-------------------+

-------------------------------------------
Batch: 5
-------------------------------------------
+-----+-----+-------------------+-------------------+
| word|count|       window_start|         window_end|
+-----+-----+-------------------+-------------------+
|Again|    3|2018-11-29 11:50:20|2018-11-29 11:50:40|
|Hello|    6|2018-11-29 11:50:20|2018-11-29 11:50:40|
+-----+-----+-------------------+-------------------+

-------------------------------------------
Batch: 6
-------------------------------------------
+-------+-----+-------------------+-------------------+
|   word|count|       window_start|         window_end|
+-------+-----+-------------------+-------------------+
|       |    2|2018-11-29 11:50:40|2018-11-29 11:51:00|
|Goodbye|    2|2018-11-29 11:50:40|2018-11-29 11:51:00|
|  Hello|    2|2018-11-29 11:50:40|2018-11-29 11:51:00|
+-------+-----+-------------------+-------------------+

-------------------------------------------
Batch: 7
-------------------------------------------
+-----+-----+-------------------+-------------------+
| word|count|       window_start|         window_end|
+-----+-----+-------------------+-------------------+
|Again|    2|2018-11-29 11:51:00|2018-11-29 11:51:20|
|Hello|    2|2018-11-29 11:51:00|2018-11-29 11:51:20|
|     |    2|2018-11-29 11:51:00|2018-11-29 11:51:20|
+-----+-----+-------------------+-------------------+



--------------------------------------------------------- 

 18_single_step_window.py

--------------------------------------------------------- 

In this example we edit the previous code so as to add a second chained aggregation. This leads to the following error: 

ERROR: 'Multiple streaming aggregations are not supported with streaming DataFrames/Datasets' 
 


--------------------------------------------------------- 

 19_drop_duplicates.py

--------------------------------------------------------- 

Although the documentation says that "Distinct operations on streaming Datasets are not supported" in this example we can apply drop_duplicates with no problem. 

-------------------------------------------
Step: 0
-------------------------------------------
2018-11-29T14:08:36.736Z;Goodbye
2018-11-29T14:08:36.736Z;Hello

-------------------------------------------
Step: 1
-------------------------------------------
2018-11-29T14:09:00.040Z;Hello
2018-11-29T14:09:00.040Z;Again

-------------------------------------------
Step: 2
-------------------------------------------
2018-11-29T14:09:20.036Z;Hello
2018-11-29T14:09:20.036Z;Again

-------------------------------------------
Step: 3
-------------------------------------------
2018-11-29T14:09:40.042Z;Hello
2018-11-29T14:09:40.042Z;Goodbye
2018-11-29T14:09:40.042Z;""

-------------------------------------------
Step: 4
-------------------------------------------
2018-11-29T14:10:00.041Z;""
2018-11-29T14:10:00.041Z;Again
2018-11-29T14:10:00.041Z;Hello

-------------------------------------------
Step: 5
-------------------------------------------
2018-11-29T14:10:20.039Z;Again
2018-11-29T14:10:20.039Z;Hello
2018-11-29T14:10:20.039Z;""



--------------------------------------------------------- 

 20_raw_sorting.py

--------------------------------------------------------- 

ERROR: Complete output mode not supported when there are no streaming aggregations on streaming DataFrames/Datasets	



--------------------------------------------------------- 

 21_sorting_after_aggregation_complete.py

--------------------------------------------------------- 

-------------------------------------------
Batch: 0
-------------------------------------------
+-------+-----+-------------------+-------------------+
|   word|count|       window_start|         window_end|
+-------+-----+-------------------+-------------------+
|Goodbye|    3|2018-11-29 17:28:00|2018-11-29 17:28:20|
|  Hello|    3|2018-11-29 17:28:00|2018-11-29 17:28:20|
+-------+-----+-------------------+-------------------+

-------------------------------------------
Batch: 1
-------------------------------------------
+-------+-----+-------------------+-------------------+
|   word|count|       window_start|         window_end|
+-------+-----+-------------------+-------------------+
|Goodbye|    3|2018-11-29 17:28:00|2018-11-29 17:28:20|
|  Hello|    3|2018-11-29 17:28:00|2018-11-29 17:28:20|
|  Hello|    3|2018-11-29 17:28:20|2018-11-29 17:28:40|
|  Again|    3|2018-11-29 17:28:20|2018-11-29 17:28:40|
+-------+-----+-------------------+-------------------+

-------------------------------------------
Batch: 2
-------------------------------------------
+-------+-----+-------------------+-------------------+
|   word|count|       window_start|         window_end|
+-------+-----+-------------------+-------------------+
|Goodbye|    3|2018-11-29 17:28:00|2018-11-29 17:28:20|
|  Hello|    3|2018-11-29 17:28:00|2018-11-29 17:28:20|
|  Hello|    3|2018-11-29 17:28:20|2018-11-29 17:28:40|
|  Again|    3|2018-11-29 17:28:20|2018-11-29 17:28:40|
|  Hello|    6|2018-11-29 17:28:40|2018-11-29 17:29:00|
|  Again|    3|2018-11-29 17:28:40|2018-11-29 17:29:00|
+-------+-----+-------------------+-------------------+

-------------------------------------------
Batch: 3
-------------------------------------------
+-------+-----+-------------------+-------------------+
|   word|count|       window_start|         window_end|
+-------+-----+-------------------+-------------------+
|Goodbye|    3|2018-11-29 17:28:00|2018-11-29 17:28:20|
|  Hello|    3|2018-11-29 17:28:00|2018-11-29 17:28:20|
|  Hello|    3|2018-11-29 17:28:20|2018-11-29 17:28:40|
|  Again|    3|2018-11-29 17:28:20|2018-11-29 17:28:40|
|  Hello|    6|2018-11-29 17:28:40|2018-11-29 17:29:00|
|  Again|    3|2018-11-29 17:28:40|2018-11-29 17:29:00|
|       |    2|2018-11-29 17:29:00|2018-11-29 17:29:20|
|  Hello|    2|2018-11-29 17:29:00|2018-11-29 17:29:20|
|Goodbye|    2|2018-11-29 17:29:00|2018-11-29 17:29:20|
+-------+-----+-------------------+-------------------+

-------------------------------------------
Batch: 4
-------------------------------------------
+-------+-----+-------------------+-------------------+
|   word|count|       window_start|         window_end|
+-------+-----+-------------------+-------------------+
|Goodbye|    3|2018-11-29 17:28:00|2018-11-29 17:28:20|
|  Hello|    3|2018-11-29 17:28:00|2018-11-29 17:28:20|
|  Hello|    3|2018-11-29 17:28:20|2018-11-29 17:28:40|
|  Again|    3|2018-11-29 17:28:20|2018-11-29 17:28:40|
|  Hello|    6|2018-11-29 17:28:40|2018-11-29 17:29:00|
|  Again|    3|2018-11-29 17:28:40|2018-11-29 17:29:00|
|       |    2|2018-11-29 17:29:00|2018-11-29 17:29:20|
|  Hello|    2|2018-11-29 17:29:00|2018-11-29 17:29:20|
|Goodbye|    2|2018-11-29 17:29:00|2018-11-29 17:29:20|
|       |    2|2018-11-29 17:29:20|2018-11-29 17:29:40|
|  Hello|    2|2018-11-29 17:29:20|2018-11-29 17:29:40|
|  Again|    2|2018-11-29 17:29:20|2018-11-29 17:29:40|
+-------+-----+-------------------+-------------------+

-------------------------------------------
Batch: 5
-------------------------------------------
+-------+-----+-------------------+-------------------+
|   word|count|       window_start|         window_end|
+-------+-----+-------------------+-------------------+
|Goodbye|    3|2018-11-29 17:28:00|2018-11-29 17:28:20|
|  Hello|    3|2018-11-29 17:28:00|2018-11-29 17:28:20|
|  Hello|    3|2018-11-29 17:28:20|2018-11-29 17:28:40|
|  Again|    3|2018-11-29 17:28:20|2018-11-29 17:28:40|
|  Hello|    6|2018-11-29 17:28:40|2018-11-29 17:29:00|
|  Again|    3|2018-11-29 17:28:40|2018-11-29 17:29:00|
|       |    2|2018-11-29 17:29:00|2018-11-29 17:29:20|
|  Hello|    2|2018-11-29 17:29:00|2018-11-29 17:29:20|
|Goodbye|    2|2018-11-29 17:29:00|2018-11-29 17:29:20|
|       |    2|2018-11-29 17:29:20|2018-11-29 17:29:40|
|  Hello|    2|2018-11-29 17:29:20|2018-11-29 17:29:40|
|  Again|    2|2018-11-29 17:29:20|2018-11-29 17:29:40|
|  Again|    2|2018-11-29 17:29:40|2018-11-29 17:30:00|
|  Hello|    4|2018-11-29 17:29:40|2018-11-29 17:30:00|
|       |    2|2018-11-29 17:29:40|2018-11-29 17:30:00|
+-------+-----+-------------------+-------------------+



--------------------------------------------------------- 

 22_sorting_after_aggregation_append.py

--------------------------------------------------------- 

ERROR: 'Sorting is not supported on streaming DataFrames/Datasets, unless it is on aggregated DataFrame/Dataset in Complete output mode'






